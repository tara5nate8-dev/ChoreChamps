<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ChoreChamps</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style> body {{ font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji"; }} </style>
  <!-- Firebase compat SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
</head>
<body class="bg-gray-50">

<main class="max-w-5xl mx-auto p-6 space-y-6">
  <header class="flex items-center justify-between">
    <h1 class="text-3xl font-extrabold">üè† ChoreChamps ‚Äî Home</h1>
    <nav class="space-x-2">
      <a class="px-3 py-2 bg-white shadow rounded-xl border" href="liam.html">Liam</a>
      <a class="px-3 py-2 bg-white shadow rounded-xl border" href="maggie.html">Maggie</a>
      <a class="px-3 py-2 bg-white shadow rounded-xl border" href="parent.html">Parent</a>
    </nav>
  </header>

  <section class="grid md:grid-cols-2 gap-4" id="cards">
    <!-- Cards injected here -->
  </section>
</main>
<script>
// --- Firebase config (update only if your project changes) ---
const firebaseConfig = {{
  apiKey: "AIzaSyDGzTazPvOiEhTDPg5jyIO17pfv9lCM3OI",
  authDomain: "chore-chart-2.firebaseapp.com",
  databaseURL: "https://parsell-family-chore-chart-default-rtdb.firebaseio.com",
  projectId: "chore-chart-2",
  storageBucket: "chore-chart-2.appspot.com",
  messagingSenderId: "881327854483",
  appId: "1:881327854483:web:b6f10033c0840a1ccb8e66"
}};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
// Global helpers
const DAYS = ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];
function prettyName(base){{ return base.replace(/([A-Z])/g, m=>' '+m).trim(); }}
</script>

<script>
// Tunable weekly targets (keep your old logic: two buckets)
const REQUIRED = {{
  liam:   {{ personal: 10, shared: 5 }},
  maggie: {{ personal: 10, shared: 5 }}
}};

function splitChoresFor(chores, child){{
  const other = child==='liam' ? 'maggie' : 'liam';
  const mine = Object.entries(chores)
    .filter(([k]) => k.startsWith(child))
    .map(([k,v]) => {{
      const base = k.replace(/^liam|^maggie/,'');
      const shared = !!chores[other + base];
      return {{ key:k, base, value:v, shared }};
    }});
  return {{
    personal: mine.filter(c=>!c.shared),
    shared:   mine.filter(c=> c.shared)
  }};
}}
function countDone(list){{
  return list.reduce((s,c)=> s + (Array.isArray(c.value) ? c.value.filter(Boolean).length : (c.value?1:0)), 0);
}}

function render(chores){{
  const liam = splitChoresFor(chores, 'liam');
  const mag  = splitChoresFor(chores, 'maggie');

  const lPersonal = countDone(liam.personal), lShared = countDone(liam.shared);
  const mPersonal = countDone(mag.personal),  mShared = countDone(mag.shared);

  const cards = [
    {{ name:'Liam',   p:lPersonal, s:lShared, req:REQUIRED.liam   }},
    {{ name:'Maggie', p:mPersonal, s:mShared, req:REQUIRED.maggie }}
  ];
  const html = cards.map(c => `
    <div class="bg-white border rounded-2xl shadow p-5">
      <div class="flex items-center justify-between">
        <h2 class="text-xl font-semibold">üèÜ ${{c.name}}</h2>
        <a class="text-sm text-blue-600 underline" href="${{c.name.toLowerCase()}}.html">Open dashboard ‚Üí</a>
      </div>
      <div class="mt-4 grid grid-cols-2 gap-3">
        <div class="bg-gray-50 rounded-xl p-4">
          <div class="text-gray-600 text-sm">Personal done</div>
          <div class="text-2xl font-bold">${{c.p}} / ${{c.req.personal}}</div>
        </div>
        <div class="bg-gray-50 rounded-xl p-4">
          <div class="text-gray-600 text-sm">Shared done</div>
          <div class="text-2xl font-bold">${{c.s}} / ${{c.req.shared}}</div>
        </div>
      </div>
      <div class="mt-3 text-sm">Left to goal: <b>${{Math.max(c.req.personal - c.p,0)}}</b> personal,
        <b>${{Math.max(c.req.shared - c.s,0)}}</b> shared.</div>
    </div>`).join('');
  document.getElementById('cards').innerHTML = html;
}}

db.ref('choreData/chores').on('value', s => render(s.val()||{{}}));
</script>
</body></html>
